{{- with site.Params.homeInfoParams }}
<article class="first-entry home-info">
    <header class="entry-header">
        <h1>{{ .Title | markdownify }}</h1>
    </header>
    <div class="entry-content">
        {{ .Content | markdownify }}
    </div>

    <div style="margin-top: 2rem; padding: 1.5rem; background: linear-gradient(145deg, rgba(var(--primary-rgb), 0.08), rgba(var(--primary-rgb), 0.02)); border: 1px solid var(--primary); border-radius: 12px; max-width: 500px; margin-left: auto; margin-right: auto; box-shadow: 0 0 14px rgba(var(--primary-rgb), 0.25);">
      <h3 style="margin-top: 0; margin-bottom: 1rem; font-size: 1.2rem; display: flex; align-items: center; gap: 8px; text-shadow: 0 0 8px rgba(var(--primary-rgb), 0.45);">üéõÔ∏è Boombox & Admin Command Tool</h3>
      <input type="text" id="cmdInput" placeholder="Enter Song ID here..." style="width: 100%; padding: 12px; margin-bottom: 15px; border-radius: 8px; border: 1px solid #555; background: var(--entry); color: var(--primary); font-family: monospace;">
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
        <button onclick="copyBoomboxId()" style="padding: 12px; background: var(--primary); color: var(--theme); border: none; border-radius: 8px; cursor: pointer; font-weight: bold; box-shadow: 0 0 10px rgba(var(--primary-rgb), 0.4);">üìã Copy Boombox ID</button>
        <button onclick="copyAdminCommand()" style="padding: 12px; background: transparent; border: 2px solid var(--primary); color: var(--primary); border-radius: 8px; cursor: pointer; font-weight: bold; text-shadow: 0 0 6px rgba(var(--primary-rgb), 0.35);">üì¢ Copy Admin Command</button>
      </div>
      <p id="dynamicGuide" style="font-size: 0.85rem; margin-top: 10px; opacity: 0.85;">To play this song, equip your Boombox, click it, and paste <strong>[ID]</strong>. Or type <strong>:music [ID]</strong> in the game chat if you have admin perms.</p>
      <p id="copyStatus" style="font-size: 0.8rem; opacity: 0.8; margin-top: 6px; text-align: center;"></p>
    </div>

    <footer class="entry-footer">
        {{ partial "social_icons.html" (dict "align" site.Params.homeInfoParams.AlignSocialIconsTo) }}
    </footer>
</article>

<script>
function getId() {
  const v = String(document.getElementById('cmdInput').value || '').trim();
  const m = v.match(/\d+/);
  return m ? m[0] : '';
}

function copyText(text) {
  if (!text) return Promise.reject();
  if (navigator.clipboard && window.isSecureContext) {
    return navigator.clipboard.writeText(text);
  }
  const ta = document.createElement('textarea');
  ta.value = text;
  ta.style.position = 'fixed';
  ta.style.top = '-1000px';
  document.body.appendChild(ta);
  ta.focus();
  ta.select();
  let ok = false;
  try { ok = document.execCommand('copy'); } catch (e) { ok = false; }
  document.body.removeChild(ta);
  return ok ? Promise.resolve() : Promise.reject();
}

function setStatus(msg) {
  const el = document.getElementById('copyStatus');
  el.textContent = msg || '';
}

function updateGuide() {
  const id = getId();
  const g = document.getElementById('dynamicGuide');
  const shown = id || '[ID]';
  g.innerHTML = `To play this song, equip your Boombox, click it, and paste <strong>${shown}</strong>. Or type <strong>:music ${shown}</strong> in the game chat if you have admin perms.`;
}

function copyBoomboxId() {
  const id = getId();
  if (!id) { setStatus('Please enter a numeric ID.'); return; }
  copyText(id).then(function(){ setStatus('ID Copied! Paste it in your Boombox.'); }).catch(function(){ setStatus('Copy failed. Please copy manually.'); });
}

function copyAdminCommand() {
  const id = getId();
  if (!id) { setStatus('Please enter a numeric ID.'); return; }
  const cmd = `:music ${id}`;
  copyText(cmd).then(function(){ setStatus('Command Copied! Type it in chat.'); }).catch(function(){ setStatus('Copy failed. Please copy manually.'); });
}

document.getElementById('cmdInput').addEventListener('input', updateGuide);
updateGuide();
</script>
{{- end -}}
